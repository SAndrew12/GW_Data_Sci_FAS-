---
title: "Mental Health Outcomes in Gamers"
author: "Team 5 -- DATS 6101"
# date: "today"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: show
    number_sections: false
    toc: yes
    toc_depth: 3
    toc_float: yes
---

```{r init, include=F}
library(ezids)
library(readr)
library(ggplot2)
library(dplyr)
library(stringr)
library(rstatix)
library(knitr)
library(kableExtra)
library(reshape2)
```


```{r setup, include=FALSE}
# some of common options (and the defaults) are: 
# include=T, eval=T, echo=T, results='hide'/'asis'/'markup',..., collapse=F, warning=T, message=T, error=T, cache=T, fig.width=6, fig.height=4, fig.dim=c(6,4) #inches, fig.align='left'/'center','right', 
knitr::opts_chunk$set(warning = F, results = "markup", message = F)
options(scientific=T, digits = 3) 
```

```{r read-in, include=TRUE}
df <- read.csv("GamingStudy_data.csv")
```


## Introduction

### Reasearch Question

ffnvjnvfijvnerijnvrejivnerijvnerijvnervijnerv
jnevirenviernvirenviernviernveriunveriuvneruivnrev
rejivnpreinvervnervnervneprovnerpouvn

### The Data

ijsvisdjnvijsdnvijsdnvskmosdmvosmdos

### Mental Health Inventories and Predictors 

GAD-7, SPIN, SWL...

Hours, Streams.....


## Exploratory Data Analysis 

### Respondent Demographics 

``` {r, countryplot}
Residence_counts <- as.data.frame(table(df$Residence))
colnames(Residence_counts) <- c("Residence", "SurveyCount")
Residence_counts <- Residence_counts[order(-Residence_counts$SurveyCount), ]

# Keep only the top 10 residences
top_10_residences <- head(Residence_counts, 20)

# Create the plot
fig <- ggplot(top_10_residences, aes(x = reorder(Residence, -SurveyCount), y = SurveyCount)) +
  geom_bar(stat = 'identity', fill = '#232A75') +
  geom_text(aes(label = SurveyCount), vjust = -0.5, color = 'white') +
  labs(title = 'Top 20 Residence Distribution', 
       x = '', 
       y = 'Total Surveyors') +
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

# Print the figure
print(fig)
```

words about plot

``` {r, gameplot}
game_counts <- as.data.frame(table(df$Game))
colnames(game_counts) <- c("Game", "SurveyCount")
game_counts <- game_counts[order(-game_counts$SurveyCount), ]

# Create the plot
fig <- ggplot(game_counts, aes(x = reorder(Game, -SurveyCount), y = SurveyCount)) +
  geom_bar(stat = 'identity', fill = '#232A75') +
  labs(title = 'Game Distribution', 
       subtitle = '', 
       x = '', 
       y = 'Total Surveyors') +
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
  theme_minimal()  +
 theme(plot.title = element_text(hjust = 0.5))
# Print the figure
print(fig)
```


``` {r, genderplot}
gender_counts <- as.data.frame(table(df$Gender))
colnames(gender_counts) <- c("Gender", "SurveyCount")
gender_counts <- gender_counts[order(-gender_counts$SurveyCount), ]

# Create the plot
fig <- ggplot(gender_counts, aes(x = reorder(Gender, -SurveyCount), y = SurveyCount)) +
  geom_bar(stat = 'identity', fill = '#232A75') +
  labs(title = 'Gender Distribution', 
       subtitle = '', 
       x = '', 
       y = 'Total Respondents') +
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
  theme_minimal()  +
 theme(plot.title = element_text(hjust = 0.5))

# Print the figure
print(fig)
```

words.....


``` {r, age}
age_counts <- as.data.frame(table(df$Age))
colnames(age_counts) <- c("Age", "SurveyCount")
age_counts <- age_counts[order(-age_counts$SurveyCount), ]

# Create the plot
fig <- ggplot(age_counts, aes(x = reorder(Age, -SurveyCount), y = SurveyCount)) +
  geom_bar(stat = 'identity', fill = '#232A75') +
  labs(title = 'Age Distribution', 
       subtitle = '', 
       x = 'Age', 
       y = 'Total Respondents') +
  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +
  theme_minimal()  +
 theme(plot.title = element_text(hjust = 0.5))

# Print the figure
print(fig)

```

words....

### Distribution of Inventories 

GAD 

```{r, gaddist}
ggplot(data = df, aes(x = GAD_T)) +
  geom_histogram(binwidth = 1,
                 color = "red",
                 fill = "blue",
                 alpha = .7) + # opacity
  labs(x = "GAD Total Score", y = "Frequency", title = "GAD Distribution") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))
```
words....


SWL 

```{r, swldist}
ggplot(data = df, aes(x = SWL_T)) +
  geom_histogram(binwidth = 1,
                 color = "pink",
                 fill = "green",
                 alpha = .7) + # opacity
  labs(x = "SWL Total Score", y = "Frequency", title = "SWL Distribution") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))
```


SPIN 

```{r, spindist}
ggplot(data = df, aes(x = SPIN_T)) +
  geom_histogram(binwidth = 1,
                 color = "orange",
                 fill = "purple",
                 alpha = .7) + # opacity
  labs(x = "SPIN Total Score", y = "Frequency", title = "SPIN Distribution") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))
```

words....

Maybe there is a way to make all three plots side-by-side??


### Below is all the code for LOG and SCALE() Transforms...Anith, up to you if we show any of this

#### Applying log transform to GAD and SPIN to make them more normal

```{r, logtransgad}
# Log-transform the GAD_T column (adding 1 to avoid log(0))
df$log_GAD_T <- log(df$GAD_T + 1)

# Create the histogram with a KDE curve
ggplot(data = df, aes(x = log_GAD_T)) +
  geom_histogram(aes(y = ..density..),  # Use density for y-axis
                 binwidth = 0.5,
                 color = "red",
                 fill = "blue",
                 alpha = 0.7) +  # Opacity
  geom_density(color = "green",           # Color of the KDE curve
               size = 1,                  # Thickness of the curve
               adjust = 1) +              # Adjust bandwidth for fitting
  labs(x = "GAD Log Total Score", 
       y = "Density",                   # Change to Density for y-axis
       title = "GAD Log Distribution with KDE") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

qqnorm(df$log_GAD_T, main="Q-Q plot for Log GAD") 
qqline(df$log_GAD_T)
```



```{r, logtransswl}
# Log-transform the SPIN_T column (adding 1 to avoid log(0))
df$log_SPIN_T <- log(df$SPIN_T + 1)

# Create the histogram with a KDE curve
ggplot(data = df, aes(x = log_SPIN_T)) +
  geom_histogram(aes(y = ..density..),  # Use density for y-axis
                 binwidth = 1,
                 color = "orange",
                 fill = "purple",
                 alpha = 0.7) +  # Opacity
  geom_density(color = "blue",           # Color of the KDE curve
               size = 1,                 # Thickness of the curve
               adjust = 1) +             # Adjust bandwidth for fitting
  labs(x = "SPIN Log Total Score", 
       y = "Density",                  # Change to Density for y-axis
       title = "SPIN Log Distribution with KDE") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

qqnorm(df$log_SPIN_T, main="Q-Q plot for Log SPIN") 
qqline(df$log_SPIN_T)


```

```{r}
# boxplot(mlb$height, main="Boxplot of Baseball Player Height", ylab="Height (inches)", col = 'red' )
# ggplot(mlb, aes(y=height)) + 
#   geom_boxplot() + 
#   geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
#   labs(title="Boxplot of Baseball Player Height using `ggplot`", x="", y = "Height (inches)")
```

Now the Q-Q plot, adding a theoretical line to the plot.

```{r}
# qqnorm(mlb$height, main="Q-Q plot of Baseball Player Heights") 
# qqline(mlb$height)
# shapiro.test(mlb$height) # Shapiro-Wilk test for normality
# ks.test(mlb$height,pnorm) # Kolmogorov-Smirnov Tests against normal distribution
```


#### Standardizing 


``` {r, standardizing}
df$GAD_T_Stand <- scale(df$GAD_T)
df$SWL_T_Stand <- scale(df$SWL_T)
df$SPIN_T_Stand <- scale(df$SPIN_T)
```

``` {r, plotting_newGAD}
ggplot(data = df, aes(x = GAD_T_Stand)) +
  geom_histogram(binwidth = 1,
                 color = "red",
                 fill = "blue",
                 alpha = .7) + # opacity
  labs(x = "GAD Standardized", y = "Frequency", title = "GAD Stand Distribution") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

qqnorm(df$GAD_T_Stand, main="Q-Q plot for Stand GAD") 
qqline(df$GAD_T_Stand)
```

``` {r, plotting_newSWL}
# Create the histogram with a KDE curve
ggplot(data = df, aes(x = SWL_T_Stand)) +
  geom_histogram(aes(y = ..density..),  # Use density for y-axis
                 binwidth = 1,
                 color = "orange",
                 fill = "purple",
                 alpha = 0.7) +  # Opacity
  geom_density(color = "blue",           # Color of the KDE curve
               size = 1,                 # Thickness of the curve
               adjust = 1) +             # Adjust bandwidth for fitting
  labs(x = "GAD Stand Log Total Score", 
       y = "Density",                  # Change to Density for y-axis
       title = "GAD Stand Distribution with KDE") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

qqnorm(df$SWL_T_Stand, main="Q-Q plot for Stand SWL") 
qqline(df$SWL_T_Stand)
```

``` {r, plotting_newSPIN}
# Create the histogram with a KDE curve
ggplot(data = df, aes(x = SPIN_T_Stand)) +
  geom_histogram(aes(y = ..density..),  # Use density for y-axis
                 binwidth = 1,
                 color = "orange",
                 fill = "purple",
                 alpha = 0.7) +  # Opacity
  geom_density(color = "blue",           # Color of the KDE curve
               size = 1,                 # Thickness of the curve
               adjust = 1) +             # Adjust bandwidth for fitting
  labs(x = "GAD Stand Log Total Score", 
       y = "Density",                  # Change to Density for y-axis
       title = "GAD Stand Distribution with KDE") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

qqnorm(df$SPIN_T_Stand, main="Q-Q plot for Stand SPIN") 
qqline(df$SPIN_T_Stand)

mean_spin = mean(df$SPIN_T_Stand, na.rm = TRUE)
mean_spin
```

### Converstion to Ordinal (thinking that maybe a screenshot of how we present the info the slides would make it clear for a non-technical audience?)

``` {r, ord}
# Function to convert GAD_T to ordinal variable
convert_GAD <- function(score) {
  if (is.na(score)) return(NA)  # Handle NA values
  if (score >= 0 & score <= 4) {
    return("minimal anxiety")
  } else if (score >= 5 & score <= 9) {
    return("mild anxiety")
  } else if (score >= 10 & score <= 14) {
    return("moderate anxiety")
  } else if (score >= 15 & score <= 21) {
    return("severe anxiety")
  } else {
    return(NA)  # Handles scores outside defined range
  }
}

# Function to convert SWL_T to ordinal variable
convert_SWL <- function(score) {
  if (is.na(score)) return(NA)  # Handle NA values
  if (score >= 31 & score <= 35) {
    return("extremely satisfied")
  } else if (score >= 26 & score <= 30) {
    return("satisfied")
  } else if (score >= 21 & score <= 25) {
    return("slightly satisfied")
  } else if (score == 20) {
    return("neutral")
  } else if (score >= 15 & score <= 19) {
    return("slightly dissatisfied")
  } else if (score >= 10 & score <= 14) {
    return("dissatisfied")
  } else if (score >= 5 & score <= 9) {
    return("extremely dissatisfied")
  } else {
    return(NA)  # Handles scores outside defined range
  }
}

# Function to convert SPIN_T to ordinal variable
convert_SPIN <- function(score) {
  if (is.na(score)) return(NA)  # Handle NA values
  if (score >= 0 & score <= 20) {
    return("none")
  } else if (score >= 21 & score <= 30) {
    return("mild")
  } else if (score >= 31 & score <= 40) {
    return("moderate")
  } else if (score >= 41 & score <= 50) {
    return("severe")
  } else if (score >= 51 & score <= 68) {
    return("very severe")
  } else {
    return(NA)  # Handles scores outside defined range
  }
}


# Create new columns in the data frame
df$GAD_ord <- sapply(df$GAD_T, convert_GAD)
df$SWL_ord <- sapply(df$SWL_T, convert_SWL)
df$SPIN_ord <- sapply(df$SPIN_T, convert_SPIN)

#make values ordinal (min to max)
df$GAD_ord <- factor(df$GAD_ord, 
                     levels = c("minimal anxiety", "mild anxiety", "moderate anxiety", "severe anxiety"), 
                     ordered = TRUE)

df$SWL_ord <- factor(df$SWL_ord, 
                     levels = c("extremely satisfied", "satisfied", "slightly satisfied", "neutral", 
                                "slightly dissatisfied", "dissatisfied", "extremely dissatisfied"), 
                     ordered = TRUE)

df$SPIN_ord <- factor(df$SPIN_ord, 
                      levels = c("none", "mild", "moderate", "severe", "very severe"), 
                      ordered = TRUE)


# Print the updated data frame
#print(df$GAD_ord)

```


### cleaning whyplay (thinking that maybe a screenshot of how we present the info the slides would make it clear for a non-technical audience?)

``` {r, cleaningwhyplay}
clean_responses <- function(response) {
  response <- trimws(tolower(response))  # Normalize to lowercase and trim whitespace
  
  # Check for exact matches first
  if (response %in% c("winning", "improving", "relaxing", "having fun")) {
    return(response)
  }
  
  # Check for various conditions to set the response
  if (str_detect(response, "^a[\\s,\\.]", ) || 
      str_detect(response, "^1[\\s,\\.]", ) || 
      str_detect(response, "^all") || 
      str_detect(response, "^mix") || 
      str_detect(response, "combination") || 
      str_detect(response, "everything")) {
    return("all of the above")
  }
  
  if (str_detect(response, "distraction|escaping|escape|forget|hide|hiding|depression|boredom|bored|time|forgetting|making my brain go numb|distracting|doing something|getting away from real life|trying to get my mind off")) {
    return("escape")
  }

  if (str_detect(response, "improve|improving|learn|learning")) {
    return("improving")
  }
  
  if (str_detect(response, "well|perform|performing")) {
    return("winning")
  }
  
  if (str_detect(response, "social|socializing|friends|team|cooperating|people|the people i play with, the game is less important")) {
    return("social")
  }
  
  if (str_detect(response, "win|winning|beating|victory|competeing|competing|competition|conpeting")) {
    return("winning")
  }
  
  if (str_detect(response, "winning") && str_detect(response, "improving")) {
    return("mix")
  }
  
  if (str_detect(response, "relaxing") && str_detect(response, "fun")) {
    return("mix")
  }
  
  if (str_detect(response, "combination|all")) {
    return("mix")
  }
  
  if (str_detect(response, "fun")) {
    return("having fun")
  }
  
  # Default to original response if no condition is met
  return("bad response")
}

# Apply the cleaning function to the 'whyplay' column
df$cleaned_whyplay <- sapply(df$whyplay, clean_responses)

# Count the occurrences of each cleaned response
whyplay_counts <- as.data.frame(table(df$cleaned_whyplay))
```

```{r, why }

colnames(whyplay_counts) <- c("WhyPlay", "SurveyCount")


whyplay_counts <- whyplay_counts[order(-whyplay_counts$SurveyCount), ]


whyplay_counts$WhyPlay <- factor(whyplay_counts$WhyPlay, levels = whyplay_counts$WhyPlay)


fig <- ggplot(whyplay_counts, aes(x = WhyPlay, y = SurveyCount)) +
  geom_bar(stat = 'identity', fill = '#232A75') +
  labs(title = 'Reasons for Playing', 
       subtitle = '', 
       caption = 'Data Source: Survey Data', 
       x = 'Reasons for Playing', 
       y = 'Total Respondents') +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))


print(fig)
```

### Removing Outliers in Hours and Streams

#### Hours
#### Finding outliers in Hours

```{r}

# Replace missing values in the Hours column with NA explicitly
hrs_data_cleaned <- df %>%
  mutate(Hours = ifelse(is.na(Hours), NA, Hours))
missing_values <- colSums(is.na(hrs_data_cleaned))

# Filter necessary columns
hrs_GAD_filtered <- hrs_data_cleaned %>%
  select(Hours, GAD1:GAD7, GAD_T)

# Finding outliers in Hours
ggplot(hrs_GAD_filtered, aes(x=Hours)) + 
  geom_boxplot() + 
  geom_boxplot(colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
  labs(title="Outliers in Hours spent gaming per week", x="Hours spent (per week)", y = "") +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),  # Center and bold title
    axis.title.x = element_text(hjust = 0.5, face = "bold"), # Bold and center x-axis label
    axis.title.y = element_text(hjust = 0.5, face = "bold")  # Bold and center y-axis label
  )
```

words about plot

#### Removing outliers in Hours and generating QQ-plot

```{r}
# Define the outlierKD2 function
outlierKD2 <- function(dt, var, rm = TRUE, boxplt = TRUE, qqplt = TRUE) { 
  var_name <- eval(substitute(var),eval(dt))
  na1 <- sum(is.na(var_name))
  m1 <- mean(var_name, na.rm = TRUE)
  
  # Generate plots (boxplot and histogram)
  if (boxplt) {
    par(mfrow = c(2, 2), oma = c(0, 0, 3, 0))
    boxplot(var_name, main = "With outliers")
    hist(var_name, main = "With outliers", xlab = NA, ylab = NA)
  }
  
  outlier <- boxplot.stats(var_name)$out
  mo <- mean(outlier)
  
  var_name <- ifelse(var_name %in% outlier, NA, var_name)
  
  if (boxplt) {
    boxplot(var_name, main = "Without outliers")
    hist(var_name, main = "Without outliers", xlab = NA, ylab = NA)
  }
  
  # Generate QQ plot if requested
  if (qqplt) {
    qqnorm(var_name)
    qqline(var_name)
  }
  
  na2 <- sum(is.na(var_name))
  
  cat("Outliers identified:", na2 - na1, "\n")
  cat("Proportion (%) of outliers:", round((na2 - na1) / sum(!is.na(var_name)) * 100, 1), "\n")
  cat("Mean of the outliers:", round(mo, 2), "\n")
  m2 <- mean(var_name, na.rm = TRUE)
  cat("Mean without removing outliers:", round(m1, 2), "\n")
  cat("Mean if we remove outliers:", round(m2, 2), "\n")
  
  # Option to remove outliers (replace with NA)
  if (rm) {
    dt[[as.character(substitute(var))]] <- invisible(var_name)
    assign(as.character(as.list(match.call())$dt), dt, envir = .GlobalEnv)
    cat("Outliers successfully removed\n")
    return(invisible(dt))
  } else {
    cat("Nothing changed\n")
    return(invisible(var_name))
  }
}

# Use outlierKD2 to remove outliers from 'Hours'
hrs_GAD_filtered_clean <- outlierKD2(hrs_GAD_filtered, Hours, rm = TRUE, boxplt = FALSE, qqplt = TRUE)

```



#### Create a histogram and boxplot for Cleaned Hours 

```{r}
hist(hrs_GAD_filtered_clean$Hours, main = "Histogram of Hours Spent Gaming", xlab = "Hours spent (per week)", col = "lightblue")

ggplot(hrs_GAD_filtered_clean, aes(x=hrs_GAD_filtered_clean$Hours)) + 
  geom_boxplot() + 
  geom_boxplot(colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
  labs(title="Hours spent gaming per week (Outliers excluded)", x="Hours spent (per week)", y = "") +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),  # Center and bold title
    axis.title.x = element_text(hjust = 0.5, face = "bold"), # Bold and center x-axis label
    axis.title.y = element_text(hjust = 0.5, face = "bold")  # Bold and center y-axis label
  )
```

words about plot

#### Streams
#### Finding outliers in Streams 

```{r}
ggplot(df, aes(x=streams)) + 
  geom_boxplot() + 
  geom_boxplot(colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
  labs(title="Outliers in streaming per week", x="Streaming (per week)", y = "") +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),  # Center and bold title
    axis.title.x = element_text(hjust = 0.5, face = "bold"), # Bold and center x-axis label
    axis.title.y = element_text(hjust = 0.5, face = "bold")  # Bold and center y-axis label
  )


```

words about plot


#### Removing outliers in Streams and generating QQ-plot

```{r}
# Define the outlierKD2 function 
outlierKD2 <- function(dt, var, rm = TRUE, boxplt = TRUE, qqplt = TRUE) { 
  var_name <- eval(substitute(var),eval(dt))
  na1 <- sum(is.na(var_name))
  m1 <- mean(var_name, na.rm = TRUE)
  
  # Generate plots (boxplot and histogram)
  if (boxplt) {
    par(mfrow = c(2, 2), oma = c(0, 0, 3, 0))
    boxplot(var_name, main = "With outliers")
    hist(var_name, main = "With outliers", xlab = NA, ylab = NA)
  }
  
  outlier <- boxplot.stats(var_name)$out
  mo <- mean(outlier)
  
  var_name <- ifelse(var_name %in% outlier, NA, var_name)
  
  if (boxplt) {
    boxplot(var_name, main = "Without outliers")
    hist(var_name, main = "Without outliers", xlab = NA, ylab = NA)
  }
  
  # Generate QQ plot if requested
  if (qqplt) {
    qqnorm(var_name)
    qqline(var_name)
  }
  
  na2 <- sum(is.na(var_name))
  
  cat("Outliers identified:", na2 - na1, "\n")
  cat("Proportion (%) of outliers:", round((na2 - na1) / sum(!is.na(var_name)) * 100, 1), "\n")
  cat("Mean of the outliers:", round(mo, 2), "\n")
  m2 <- mean(var_name, na.rm = TRUE)
  cat("Mean without removing outliers:", round(m1, 2), "\n")
  cat("Mean if we remove outliers:", round(m2, 2), "\n")
  
  # Option to remove outliers (replace with NA)
  if (rm) {
    dt[[as.character(substitute(var))]] <- invisible(var_name)
    assign(as.character(as.list(match.call())$dt), dt, envir = .GlobalEnv)
    cat("Outliers successfully removed\n")
    return(invisible(dt))
  } else {
    cat("Nothing changed\n")
    return(invisible(var_name))
  }
}

# Use outlierKD2 to remove outliers from 'streams'
df_clean <- outlierKD2(df, streams, rm = TRUE, boxplt = FALSE, qqplt = TRUE)

```



#### Create a histogram and boxplot for Cleaned Streams

```{r}
hist(df_clean$streams, main = "Histogram of Time Spent watching Steams, Tournaments, etc. (hrs/week)
", xlab = "Time Spent watching Steams, Tournaments, etc. (hrs/week)
 ", col = "lightblue")

ggplot(df_clean, aes(x=df_clean$streams)) + 
  geom_boxplot() + 
  geom_boxplot(colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
  labs(title="Streaming per week (Outliers excluded )", x="Streaming (per week)", y = "") +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),  # Center and bold title
    axis.title.x = element_text(hjust = 0.5, face = "bold"), # Bold and center x-axis label
    axis.title.y = element_text(hjust = 0.5, face = "bold")  # Bold and center y-axis label
  )

```

words about plot, why standardization will be done


#### Standardizing Hours and Streams Cleaned data
``` {r}
df_clean$streams_Stand <- scale(df_clean$streams)
hrs_GAD_filtered_clean$hours_Stand <- scale(hrs_GAD_filtered_clean$Hours)

```

#### Hours histogram and QQ-plot after standardizing
```{r, plotting_hours}
# Histogram for standardized Hours
ggplot(data = hrs_GAD_filtered_clean, aes(x = hours_Stand)) +
  geom_histogram(binwidth = 1, color = "red", fill = "blue", alpha = .7) +
  labs(x = "Hours Standardized", y = "Frequency", title = "Hours Stand Distribution") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

# Q-Q plot for standardized Hours
qqnorm(hrs_GAD_filtered_clean$hours_Stand, main = "Q-Q plot for Stand Hours")
qqline(hrs_GAD_filtered_clean$hours_Stand)


```
explain


#### Stream histogram and QQ-plot after standardizing
``` {r, plotting_streams}
# Histogram for standardized Streams
ggplot(data = df_clean, aes(x = streams_Stand)) +
  geom_histogram(binwidth = 1, color = "red", fill = "blue", alpha = .7) +
  labs(x = "Streams Standardized", y = "Frequency", title = "Streams Stand Distribution") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

# Q-Q plot for standardized Streams
qqnorm(df_clean$streams_Stand, main = "Q-Q plot for Stand Streams")
qqline(df_clean$streams_Stand)

```

explain


#### Adding Hours and Streams -> Total Time, and creating histogram and QQ-plot

```{r}
# Create the new column hrs_stream_combined in df
df$hrs_stream_combined <- df_clean$streams + hrs_GAD_filtered_clean$Hours

hist(df$hrs_stream_combined, 
     main = "", # Set an empty main to customize it later
     xlab = "", # Set an empty xlab to customize it later
     ylab = "", # Set an empty ylab to customize it later
     col = "lightblue")

# Customize the title and labels
title(main = "Histogram: Total time Spent watching Streams, Tournaments, etc.",
      xlab = "Time Spent (hrs/week)",
      ylab = "Frequency",        # Add the y-axis label
      font.main = 2,  # Bold title
      font.lab = 2,   # Bold x and y labels
      cex.main = 1.2, # Adjust title size
      cex.lab = 1.2   # Adjust label size for both axes
)

# Q-Q plot for Total Time
qqnorm(df$hrs_stream_combined, main = "Q-Q plot for Total time")
qqline(df$hrs_stream_combined)


```


#### Histogram of Total Time distribution on GAD_ordinal variables
```{r}
ggplot(df, aes(x = df$hrs_stream_combined)) +
  geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
  facet_wrap(~ GAD_ord) +
  labs(title = "Histogram of Total time spent on game and streaming by GAD_ordinal",
       x = "Hours played/week",
       y = "Count") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

```

explain

Correlation?
#### Hours and Streams (Pearson's Correlation)
```{r, corr_h_s}
cor_test <- cor.test(hrs_GAD_filtered_clean$Hours, df_clean$streams)
correlation_result_Hours_Streams <- cor(hrs_GAD_filtered_clean$Hours, df_clean$streams, method = "pearson", use = "complete.obs")
cor_test
```

words about test


### Hours Converstion of Ordinal

sdcdscsdcsdcsdc












## Hypothesis Tests (add in any I am missing or change the names in needed. Each test will have a visualization)

words on each of the test we ran and why


### Hours Played and Hours Streamed (ANOVA)


This very weak negative correlation means that an increase in hours played slightly results in a lower SWL score (less life satisfaction).

### Inventories and Hours Played (ANOVA)


### GADE and WhyPlay (chi-sqaured)
.......

### Inventories and WhyPlay (chi-sqauared)

......


#### ANOVA test for Total time spent and GAD_ordinal variables

Null: There is no difference in the mean combined hours spent on gaming and streaming among the different levels of GAD.
Alternate: At least one group mean of the combined hours spent on gaming and streaming is different from the others among the different levels of GAD.
```{r}

# Combine the hours played and streams into a new variable
df$hrs_stream_combined <- df_clean$streams + hrs_GAD_filtered_clean$Hours

# Perform the ANOVA test
anova_result_combined <- aov(hrs_stream_combined ~ GAD_ord, data = df)

# Summarize the ANOVA results
summary(anova_result_combined)

```

p values small so we reject the null hypothesis. This indicates that there is a statistically significant difference in the mean combined hours spent on gaming and streaming among the different levels of GAD.

#### Post hoc test

```{r}
# Perform the ANOVA
anova_result <- aov(hrs_stream_combined ~ GAD_ord, data = df)

# Perform Tukey HSD post-hoc test
tukey_result <- TukeyHSD(anova_result)

# Display the Tukey HSD results
print(tukey_result)

# Optional: Plot the Tukey HSD results
plot(tukey_result)

```

explain

## Keys Findings 

Here we will restate the key fidnings for each test, why they matter, and what it tells us about gaming and mental health.


#### GAD_T_ordinal based on why they play
```{r GAD_ord vs why_play}


ggplot(df, aes(x = GAD_ord, fill = cleaned_whyplay)) +
  geom_bar(position = "fill") +  # Use position = "fill" to show proportions
  ylab("Proportion") +           # Label the y-axis
  xlab("Severity of the Generalized Anxiety Disorder") +           # Label the x-axis
  labs(title = "Proportion of Reasons for Playing by GAD Scores",
       fill = "Reasons for Playing") +  # Rename the legend title
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),  # Center and bold the title
    axis.title.x = element_text(face = "bold", size = 12),  # Bold and size for x-axis label
    axis.title.y = element_text(face = "bold", size = 12),  # Bold and size for y-axis label
    axis.text.x = element_text(face = "bold", size = 10),   # Bold the x-axis tick labels
    axis.text.y = element_text(face = "bold", size = 10),   # Bold the y-axis tick labels
    legend.title = element_text(face = "bold"),             # Bold the legend title
    legend.text = element_text(face = "bold")               # Bold the legend labels
  )


```

explain

####  GADE_ordinal based on why they play

```{r}
ggplot(df, aes(x = GADE, fill = cleaned_whyplay)) +
  geom_bar(position = "fill") +  # Use position = "fill" to show proportions
  ylab("Proportion") +           # Label the y-axis
  xlab("Generalized Anxiety Disorder Effect in Life") +           # Label the x-axis
  labs(title = "Proportion of Reasons for Playing by GADE Scores",
       fill = "Reasons for Playing") +  # Rename the legend title
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),  # Center and bold the title
    axis.title.x = element_text(face = "bold", size = 12),  # Bold and size for x-axis label
    axis.title.y = element_text(face = "bold", size = 12),  # Bold and size for y-axis label
    axis.text.x = element_text(face = "bold", size = 10, angle = 45, hjust = 1),   # Rotate and bold the x-axis tick labels
    axis.text.y = element_text(face = "bold", size = 10),   # Bold the y-axis tick labels
    legend.title = element_text(face = "bold"),             # Bold the legend title
    legend.text = element_text(face = "bold")               # Bold the legend labels
  )


```

explain

#### SPIN_ord_ordinal based on why they play
```{r SPIN_ord vs why_play}

ggplot(df, aes(x = SPIN_ord, fill = cleaned_whyplay)) +
  geom_bar(position = "fill") +  # Use position = "fill" to show proportions
  ylab("Proportion") +           # Label the y-axis
  xlab("Total score on the Social Phobia Inventory") +          # Label the x-axis
  labs(title = "Proportion of Reasons for Playing by SPIN Scores",
       fill = "Reasons for Playing") +  # Rename the legend title
  theme_minimal() + 
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),  # Center and bold the title
    axis.title.x = element_text(face = "bold", size = 12),  # Bold and size for x-axis label
    axis.title.y = element_text(face = "bold", size = 12),  # Bold and size for y-axis label
    axis.text.x = element_text(face = "bold", size = 10),   # Bold the x-axis tick labels
    axis.text.y = element_text(face = "bold", size = 10),   # Bold the y-axis tick labels
    legend.title = element_text(face = "bold"),             # Bold the legend title
    legend.text = element_text(face = "bold")               # Bold the legend labels
  )
  

```

explain


## Reccomednations 

Here we will state what we think should be done next (project part 2)

"We reccomedn running a logisitic regression blah blah blah" 






