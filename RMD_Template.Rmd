---
title: "Exploratory Data Analysis (EDA)"
author: "GWU Intro to Data Science -- DATS 6101"
# date: "today"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: show
    number_sections: false
    toc: yes
    toc_depth: 3
    toc_float: yes
---

```{r init, include=F}
library(ezids)
library(readr)
library(ggplot2)
library(dplyr)
```


```{r setup, include=FALSE}
# some of common options (and the defaults) are: 
# include=T, eval=T, echo=T, results='hide'/'asis'/'markup',..., collapse=F, warning=T, message=T, error=T, cache=T, fig.width=6, fig.height=4, fig.dim=c(6,4) #inches, fig.align='left'/'center','right', 
knitr::opts_chunk$set(warning = F, results = "markup", message = F)
options(scientific=T, digits = 3) 
```

## Iventory information

General Anxiety Disorder-7 (GAD): <br>
- measures severity of anxiety <br>
0 - 4 : minimal anxiety <br>
5 - 9 : mild anxiety <br>
10 - 14 : moderate anxiety <br>
15 - 21 : severe anxiety <br>

Satisfaction With Life SWL-7 (SWL)<br>
- measures and individual's perceived satisfaction with life<br>
31 - 35 : extremely satisfied <br>
26 - 30 : satisfied <br>
21 -25 : slightly satisfied <br>
20 : neutral <br>
15 - 19 : slightly dissatisfied <br>
10 - 14 : dissatisfied <br>
5 - 9 : extremely dissatisfied <br>

Social Phobia Inventory (SPIN)<br>
- Used to identify or monitor social anxiety disorder (social phobia)<br>
0 - 20 : none<br>
21 - 30 : mild<br>
31 - 40 : moderate<br>
41 - 50 : severe<br>
51 - 68 : very severe <br>

Generalized Anxiety disorder, Effect in Life (GADE) <br>
- If respondent checked off any problems during GAD-7 "how difficult have these problems made your..."<br>
 
 
Narcissism <br>
- to what extent do you agree with with this statement, "I am a narcissist" <br>

```{r read-in, include=TRUE}
df <- read_csv("C:\\Users\\steph\\Desktop\\datasci_projects\\GW_Data_Sci_FAS-\\GamingStudy_data.csv")
glimpse(df)
```


```{r, results='asis'}
# # Changing variable names (HW #3)
# colnames(mlb)[4:6]=c("height","weight","age")
# # The line above produces no output. To see the changes, use str() or head()
# xkabledplyhead(mlb, title = "Header rows for mlb dataset")
```

## Outliers adn qq

```{r, outlier_gad}
ggplot(df, aes(y=GAD_T)) + 
  geom_boxplot() + 
  geom_boxplot( colour="red", fill="gray", outlier.colour="black", outlier.shape=8, outlier.size=4) +
  labs(title="Boxplot GAD", x="", y = "Score")

qqnorm(df$GAD_T, main="Q-Q plot for GAD") 
qqline(df$GAD_T)
```

```{r, outlier_swl}
ggplot(df, aes(y=SWL_T)) + 
  geom_boxplot() + 
  geom_boxplot( colour="orange", fill="gray", outlier.colour="black", outlier.shape=8, outlier.size=4) +
  labs(title="Boxplot SWL", x="", y = "Score")

qqnorm(df$SWL_T, main="Q-Q plot for SWL") 
qqline(df$SWL_T)
```

```{r, outlier_spin}
ggplot(df, aes(y=SPIN_T)) + 
  geom_boxplot() + 
  geom_boxplot( colour="purple", fill="gray", outlier.colour="black", outlier.shape=8, outlier.size=4) +
  labs(title="Boxplot SPIN", x="", y = "Score")

qqnorm(df$SPIN_T, main="Q-Q plot for SPIN") 
qqline(df$SPIN_T)
```


## EDA Plots


```{r, gaddist}
ggplot(data = df, aes(x = GAD_T)) +
  geom_histogram(binwidth = 1,
                 color = "red",
                 fill = "blue",
                 alpha = .7) + # opacity
  labs(x = "GAD Total Score", y = "Frequency", title = "GAD Distribution") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))
```

```{r, gaddistt}
ggplot(data = df, aes(x = GAD_T)) +
  geom_histogram(aes(y = ..density..),  # Use density for y-axis
                 binwidth = 1,
                 color = "red",
                 fill = "blue",
                 alpha = 0.7) +  # Opacity
  geom_density(color = "green",          # Color of the KDE curve
               size = 1,                 # Thickness of the curve
               adjust = 1) +             # Adjust bandwidth for fitting
  labs(x = "GAD Total Score", 
       y = "Density",                 # Change to Density for y-axis
       title = "GAD Distribution with KDE") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

```

```{r, swldist}
ggplot(data = df, aes(x = SWL_T)) +
  geom_histogram(binwidth = 1,
                 color = "pink",
                 fill = "green",
                 alpha = .7) + # opacity
  labs(x = "SWL Total Score", y = "Frequency", title = "SWL Distribution") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))
```

```{r, spindist}
ggplot(data = df, aes(x = SPIN_T)) +
  geom_histogram(binwidth = 1,
                 color = "orange",
                 fill = "purple",
                 alpha = .7) + # opacity
  labs(x = "SPIN Total Score", y = "Frequency", title = "SPIN Distribution") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))
```

#### Applying log transform to GAD and SPIN to make them more normal

```{r, logtransgad}
# Log-transform the GAD_T column (adding 1 to avoid log(0))
df$log_GAD_T <- log(df$GAD_T + 1)

# Create the histogram with a KDE curve
ggplot(data = df, aes(x = log_GAD_T)) +
  geom_histogram(aes(y = ..density..),  # Use density for y-axis
                 binwidth = 0.5,
                 color = "red",
                 fill = "blue",
                 alpha = 0.7) +  # Opacity
  geom_density(color = "green",           # Color of the KDE curve
               size = 1,                  # Thickness of the curve
               adjust = 1) +              # Adjust bandwidth for fitting
  labs(x = "GAD Log Total Score", 
       y = "Density",                   # Change to Density for y-axis
       title = "GAD Log Distribution with KDE") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

qqnorm(df$log_GAD_T, main="Q-Q plot for Log GAD") 
qqline(df$log_GAD_T)
```



```{r, logtransswl}
# Log-transform the SPIN_T column (adding 1 to avoid log(0))
df$log_SPIN_T <- log(df$SPIN_T + 1)

# Create the histogram with a KDE curve
ggplot(data = df, aes(x = log_SPIN_T)) +
  geom_histogram(aes(y = ..density..),  # Use density for y-axis
                 binwidth = 1,
                 color = "orange",
                 fill = "purple",
                 alpha = 0.7) +  # Opacity
  geom_density(color = "blue",           # Color of the KDE curve
               size = 1,                 # Thickness of the curve
               adjust = 1) +             # Adjust bandwidth for fitting
  labs(x = "SPIN Log Total Score", 
       y = "Density",                  # Change to Density for y-axis
       title = "SPIN Log Distribution with KDE") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

qqnorm(df$log_SPIN_T, main="Q-Q plot for Log SPIN") 
qqline(df$log_SPIN_T)


```

```{r}
# boxplot(mlb$height, main="Boxplot of Baseball Player Height", ylab="Height (inches)", col = 'red' )
# ggplot(mlb, aes(y=height)) + 
#   geom_boxplot() + 
#   geom_boxplot( colour="orange", fill="#7777cc", outlier.colour="red", outlier.shape=8, outlier.size=4) +
#   labs(title="Boxplot of Baseball Player Height using `ggplot`", x="", y = "Height (inches)")
```

Now the Q-Q plot, adding a theoretical line to the plot.

```{r}
# qqnorm(mlb$height, main="Q-Q plot of Baseball Player Heights") 
# qqline(mlb$height)
# shapiro.test(mlb$height) # Shapiro-Wilk test for normality
# ks.test(mlb$height,pnorm) # Kolmogorov-Smirnov Tests against normal distribution
```

We'll talk more about the shapiro test after we introduce formal statistical testings. In the meantime, we can look into other EDA tools and techniques.

## Standardizing 
``` {r, standardizing}
df$GAD_T_Stand <- scale(df$GAD_T)
df$SWL_T_Stand <- scale(df$SWL_T)
df$SPIN_T_Stand <- scale(df$SPIN_T)
```

``` {r, plotting_newGAD}
ggplot(data = df, aes(x = GAD_T_Stand)) +
  geom_histogram(binwidth = 1,
                 color = "red",
                 fill = "blue",
                 alpha = .7) + # opacity
  labs(x = "GAD Standardized", y = "Frequency", title = "GAD Stand Distribution") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

qqnorm(df$GAD_T_Stand, main="Q-Q plot for Stand GAD") 
qqline(df$GAD_T_Stand)
```

``` {r, plotting_newSWL}
# Create the histogram with a KDE curve
ggplot(data = df, aes(x = SWL_T_Stand)) +
  geom_histogram(aes(y = ..density..),  # Use density for y-axis
                 binwidth = 1,
                 color = "orange",
                 fill = "purple",
                 alpha = 0.7) +  # Opacity
  geom_density(color = "blue",           # Color of the KDE curve
               size = 1,                 # Thickness of the curve
               adjust = 1) +             # Adjust bandwidth for fitting
  labs(x = "GAD Stand Log Total Score", 
       y = "Density",                  # Change to Density for y-axis
       title = "GAD Stand Distribution with KDE") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

qqnorm(df$SWL_T_Stand, main="Q-Q plot for Stand SWL") 
qqline(df$SWL_T_Stand)
```

``` {r, plotting_newSPIN}
# Create the histogram with a KDE curve
ggplot(data = df, aes(x = SPIN_T_Stand)) +
  geom_histogram(aes(y = ..density..),  # Use density for y-axis
                 binwidth = 1,
                 color = "orange",
                 fill = "purple",
                 alpha = 0.7) +  # Opacity
  geom_density(color = "blue",           # Color of the KDE curve
               size = 1,                 # Thickness of the curve
               adjust = 1) +             # Adjust bandwidth for fitting
  labs(x = "GAD Stand Log Total Score", 
       y = "Density",                  # Change to Density for y-axis
       title = "GAD Stand Distribution with KDE") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5))

qqnorm(df$SPIN_T_Stand, main="Q-Q plot for Stand SPIN") 
qqline(df$SPIN_T_Stand)

mean_spin = mean(df$SPIN_T_Stand, na.rm = TRUE)
mean_spin
```

## Pearsons Corrleation
### SWL and Hours...for now
``` {r, corr}
correlation_result <- cor(df$Hours, df$SWL_T, method = "pearson", use = "complete.obs")
print(correlation_result)

cor_test <- cor.test(df$Hours, df$SWL_T)
cor_test
```

This very weak negative correlation means that an increase in hours played slightly results in a lower SWL score (less life satisfaction).


